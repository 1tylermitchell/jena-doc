<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

  <link href="/jena-doc/css/jena.css" rel="stylesheet" type="text/css">

  <title>Apache Jena - SDB Query performance</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
  <script src="/js/jena-navigation.js" type="text/javascript"></script>
</head>

<body>
  <div id="header">
    <div id="logoblock">
    <img alt="Apache Jena" src="/images/jena-logo/jena-logo-small.png"/>
    </div>

    <div id="titleblock">
      <h1 class="title">Apache Jena</h1>
      <div id="topmenu" class="tabbar round-10">
        <ul>
        <li class="round-top-8"><a class="round-top-8" href="/jena-doc/index.html" id="home_menu">Home</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/jena-doc/help_and_support/index.html">Support</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/jena-doc/getting_started/index.html">Getting started</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/jena-doc/tutorials/index.html">Tutorials</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/jena-doc/documentation/index.html">Documentation</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div id="navigation" class="clear">
  <h1 id="quick-links">Quick links</h1>
<ul>
<li><a href="/jena-doc/index.html">Home</a></li>
<li><a href="/jena-doc/download/index.html">Downloads</a></li>
<li><a href="/jena-doc/help_and_support/index.html">Help and support</a></li>
<li><a href="/jena-doc/help_and_support/bugs_and_suggestions.html">Report a bug</a></li>
<li><a href="/jena-doc/about_jena/roadmap.html">Roadmap</a></li>
<li><a href="/jena-doc/getting_involved/index.html">Getting involved</a></li>
<li><a href="/jena-doc/documentation/">Documentation</a></li>
</ul>
<h1 id="about-jena">About Jena</h1>
<ul>
<li><a href="/jena-doc/index.html">Home</a></li>
<li><a href="/jena-doc/about_jena/about.html">About Jena</a></li>
<li><a href="/jena-doc/about_jena/architecture.html">Architecture</a></li>
<li><a href="/jena-doc/about_jena/roadmap.html">Roadmap</a></li>
<li><a href="/jena-doc/about_jena/team.html">Project team</a></li>
<li><a href="/jena-doc/about_jena/contributions.html">Related projects</a></li>
</ul>
<h1 id="download">Download</h1>
<ul>
<li><a href="/jena-doc/download/index.html">Downloading Jena</a></li>
<li><a href="/jena-doc/download/maven.html">Using Maven</a></li>
<li><a href="/jena-doc/download/osgi.html">Using OSGi</a></li>
</ul>
<h1 id="help-and-support">Help and support</h1>
<ul>
<li><a href="/jena-doc/help_and_support/index.html">Getting help</a></li>
<li><a href="/jena-doc/help_and_support/bugs_and_suggestions.html">Bugs and suggestions</a></li>
</ul>
<h1 id="getting-started">Getting Started</h1>
<ul>
<li><a href="/jena-doc/getting_started/index.html">A first Jena project</a></li>
<li><a href="/jena-doc/getting_started/rdf_api.html">RDF API overview</a></li>
<li><a href="/jena-doc/getting_started/sparql.html">Querying RDF with SPARQL</a></li>
<li><a href="/jena-doc/getting_started/fuseki.html">Serving RDF over HTTP</a></li>
<li><a href="/jena-doc/getting_started/tell_me_how.html">Tell me how to ...</a></li>
</ul>
<h1 id="tutorials">Tutorials</h1>
<ul>
<li><a href="/jena-doc/tutorials/index.html">Tutorials index</a></li>
<li><a href="/jena-doc/tutorials/rdf_api.html">RDF tutorial</a></li>
<li><a href="/jena-doc/tutorials/sparql.html">SPARQL queries</a></li>
<li><a href="/jena-doc/tutorials/using_jena_with_eclipse.html">Using Jena with Eclipse</a></li>
</ul>
<h1 id="documentation">Documentation</h1>
<ul>
<li><a href="/jena-doc/documentation/index.html">Overview</a></li>
<li><a href="/jena-doc/documentation/javadoc/">Javadoc</a></li>
<li><a href="/jena-doc/documentation/rdf/index.html">RDF</a></li>
<li><a href="/jena-doc/documentation/io/index.html">I/O</a></li>
<li><a href="/jena-doc/documentation/query/index.html">SPARQL (ARQ)</a><ul>
<li><a href="/jena-doc/documentation/query/app_api.html">Application API</a></li>
<li><a href="/jena-doc/documentation/query/cmds.html">Command line utilities</a></li>
</ul>
</li>
<li><a href="/jena-doc/documentation/query/text-query.html">Text Search</a></li>
<li><a href="/jena-doc/documentation/tdb/index.html">TDB</a><ul>
<li><a href="/jena-doc/documentation/tdb/tdb_transactions.html">API for Transactions</a></li>
<li><a href="/jena-doc/documentation/tdb/assembler.html">Dataset Assembler</a></li>
</ul>
</li>
<li><a href="/jena-doc/documentation/serving_data/index.html">Fuseki: Serving Data</a></li>
<li><a href="/jena-doc/documentation/ontology/index.html">Ontology</a></li>
<li><a href="/jena-doc/documentation/inference/index.html">Inference</a></li>
<li><a href="/jena-doc/documentation/assembler/index.html">Assembler</a><ul>
<li><a href="/jena-doc/documentation/assembler/assembler-howto.html">Assembler how-to</a></li>
<li><a href="/jena-doc/documentation/assembler/inside-assemblers.html">Inside assemblers</a></li>
</ul>
</li>
<li><a href="/jena-doc/documentation/sdb/index.html">SDB</a></li>
<li><a href="/jena-doc/documentation/notes/index.html">Notes</a><ul>
<li><a href="/jena-doc/documentation/notes/concurrency-howto.html">Concurrency how-to</a></li>
<li><a href="/jena-doc/documentation/notes/event-handler-howto.html">Event handler how-to</a></li>
<li><a href="/jena-doc/documentation/notes/file-manager.html">File manager how-to</a></li>
<li><a href="/jena-doc/documentation/notes/model-factory.html">Model factory how-to</a></li>
<li><a href="/jena-doc/documentation/notes/rdf-frames.html">RDF frames</a></li>
<li><a href="/jena-doc/documentation/notes/reification.html">Reification how-to</a></li>
<li><a href="/jena-doc/documentation/notes/typed-literals.html">Typed literals how-to</a></li>
<li><a href="/jena-doc/documentation/notes/iri.html">Support for IRI's</a></li>
<li><a href="/jena-doc/documentation/notes/sse.html">SSE</a></li>
</ul>
</li>
<li><a href="/jena-doc/documentation/tools/index.html">Tools</a><ul>
<li><a href="/jena-doc/documentation/tools/schemagen.html">schemagen</a></li>
<li><a href="/jena-doc/documentation/tools/eyeball-getting-started.html">eyeball</a></li>
</ul>
</li>
</ul>
<h1 id="getting-involved">Getting Involved</h1>
<ul>
<li><a href="/jena-doc/getting_involved/index.html">Contributing to Jena</a><ul>
<li><a href="/jena-doc/getting_involved/reviewing_contributions.html">Reviewing Contributions</a></li>
</ul>
</li>
</ul>
<h1 id="asf-links">ASF links</h1>
<ul>
<li><a href="http://www.apache.org">Apache Software Foundation</a></li>
<li><a href="http://www.apache.org/licenses/LICENSE-2.0">License</a></li>
<li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
<li><a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
<li><a href="http://www.apache.org/security/">Security</a></li>
</ul>
  </div>

  <div id="content">
    <h1 class="title">SDB Query performance</h1>
    <p>This page compares the effect of SDB with RDB, Jena's usual
database layout. RDB was designed for supporting the fine-grained
API calls as well as having some support for basic graph patterns.
Therefore, the RDB design goals were not those of SDB.</p>
<p>RDB uses a denormalised database layout in order that all
statement-level operations do not require additional joins. The
<a href="database_layouts.html" title="SDB/Database Layouts">SDB layout</a> is
normalised so that the triple table is narrower and uses integers
for RDF nodes, then does do joins to get the node representation.
This optimizers for longer patterns, not API operations.</p>
<p>These figures were taken July 2007.</p>
<p>As with any performance figures, these should be taken merely as a
guide. The shape of the data, the hardware details, choice of
database, and it's configuration (particularly amount of memory
used), as well as the queries themselves all greatly contribute to
the execution costs.</p>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="#setup">Setup</a></li>
<li><a href="#lubm-query-1">LUBM Query 1</a></li>
<li><a href="#lubm-query-2">LUBM Query 2</a></li>
<li><a href="#summary">Summary</a></li>
</ul>
<h2 id="setup">Setup</h2>
<p><a href="loading_performance.html#the-databases-and-hardware" title="SDB/Loading performance">Database and hardware setup</a>
was the same as for the
<a href="loading_performance.html" title="SDB/Loading performance">load performance</a>
tests.</p>
<p>Data was taken generated with the LUBM test generator (with N =
15), then the inference expanded on loading to give about 19.5
million triples. This data is larger than the database could
completely cache.</p>
<p>The queries are taken the LUBM suite and rewritten in SPARQL.</p>
<h2 id="lubm-query-1">LUBM Query 1</h2>
<div class="codehilite"><pre> <span class="n">PREFIX</span> <span class="n">rdf</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span>
 <span class="n">PREFIX</span> <span class="n">ub</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.lehigh.edu/~zhp2/2004/0401/univ-bench.owl#&gt;</span>
 <span class="n">SELECT</span> <span class="o">*</span> <span class="n">WHERE</span>
 <span class="p">{</span>
     <span class="o">?</span><span class="n">x</span> <span class="n">rdf</span><span class="o">:</span><span class="n">type</span> <span class="n">ub</span><span class="o">:</span><span class="n">GraduateStudent</span> <span class="p">.</span>
     <span class="o">?</span><span class="n">x</span> <span class="n">ub</span><span class="o">:</span><span class="n">takesCourse</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.Department0.University0.edu/GraduateCourse0&gt; .</span>
 <span class="p">}</span>
</pre></div>


<p>Jena: 24.16s <br />
SDB/index: 0.014s<br />
SDB/hash: 0.04s</p>
<h2 id="lubm-query-2">LUBM Query 2</h2>
<div class="codehilite"><pre> <span class="n">PREFIX</span> <span class="n">rdf</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span>
 <span class="n">PREFIX</span> <span class="n">ub</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.lehigh.edu/~zhp2/2004/0401/univ-bench.owl#&gt;</span>
 <span class="n">SELECT</span> <span class="o">*</span> <span class="n">WHERE</span>
 <span class="p">{</span>
      <span class="o">?</span><span class="n">x</span> <span class="n">rdf</span><span class="o">:</span><span class="n">type</span> <span class="n">ub</span><span class="o">:</span><span class="n">GraduateStudent</span> <span class="p">.</span>
      <span class="o">?</span><span class="n">y</span> <span class="n">rdf</span><span class="o">:</span><span class="n">type</span> <span class="n">ub</span><span class="o">:</span><span class="n">University</span> <span class="p">.</span>
      <span class="o">?</span><span class="n">z</span> <span class="n">rdf</span><span class="o">:</span><span class="n">type</span> <span class="n">ub</span><span class="o">:</span><span class="n">Department</span> <span class="p">.</span>
      <span class="o">?</span><span class="n">x</span> <span class="n">ub</span><span class="o">:</span><span class="n">memberOf</span> <span class="o">?</span><span class="n">z</span> <span class="p">.</span>
      <span class="o">?</span><span class="n">z</span> <span class="n">ub</span><span class="o">:</span><span class="n">subOrganizationOf</span> <span class="o">?</span><span class="n">y</span> <span class="p">.</span>
      <span class="o">?</span><span class="n">x</span> <span class="n">ub</span><span class="o">:</span><span class="n">undergraduateDegreeFrom</span> <span class="o">?</span><span class="n">y</span> <span class="p">.</span>
 <span class="p">}</span>
</pre></div>


<p>This query searches for a particular pattern in the data without
specific starting point.</p>
<p>Jena: 232.1s (153s with an addition index on OP) <br />
SDB/index: 12.7s <br />
SDB/hash: 3.7s</p>
<p><strong>Notes:</strong> Removing the <code>rdf:type</code> statements actually slows the query down.</p>
<h2 id="summary">Summary</h2>
<p>In SPARQL queries, there is often a sufficiently complex graph
pattern that the SDb design tradeoff provides significant
advantages in query performance.</p>
  </div>

  <div id="footer">
    <div class="copyright">
      <p>
        Copyright &copy; 2011&ndash;2013 The Apache Software Foundation, Licensed under
        the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        <br />
        Apache Jena, Jena, the Apache Jena project logo,
        Apache and the Apache feather logos are trademarks of The Apache Software Foundation.
      </p>
    </div>
  </div>

</body>
</html>
