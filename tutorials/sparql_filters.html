<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

  <link href="/css/jena.css" rel="stylesheet" type="text/css">

  <title>Apache Jena - SPARQL Tutorial - Filters</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
  <script src="/js/jena-navigation.js" type="text/javascript"></script>
</head>

<body>
  <div id="header">
    <div id="logoblock">
    <img alt="Apache Jena" src="/images/jena-logo/jena-logo-small.png"/>
    </div>

    <div id="titleblock">
      <h1 class="title">Apache Jena</h1>
      <div id="topmenu" class="tabbar round-10">
        <ul>
        <li class="round-top-8"><a class="round-top-8" href="/index.html" id="home_menu">Home</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/help_and_support/index.html">Support</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/getting_started/index.html">Getting started</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/tutorials/index.html">Tutorials</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/documentation/index.html">Documentation</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div id="navigation" class="clear">
  <h1 id="quick-links">Quick links</h1>
<ul>
<li><a href="/index.html">Home</a></li>
<li><a href="/download/index.html">Downloads</a></li>
<li><a href="/help_and_support/index.html">Help and support</a></li>
<li><a href="/help_and_support/bugs_and_suggestions.html">Report a bug</a></li>
<li><a href="/about_jena/roadmap.html">Roadmap</a></li>
<li><a href="/getting_involved/index.html">Getting involved</a></li>
<li><a href="/documentation/">Documentation</a></li>
</ul>
<h1 id="about-jena">About Jena</h1>
<ul>
<li><a href="/index.html">Home</a></li>
<li><a href="/about_jena/about.html">About Jena</a></li>
<li><a href="/about_jena/architecture.html">Architecture</a></li>
<li><a href="/about_jena/roadmap.html">Roadmap</a></li>
<li><a href="/about_jena/team.html">Project team</a></li>
<li><a href="/about_jena/contributions.html">Related projects</a></li>
</ul>
<h1 id="download">Download</h1>
<ul>
<li><a href="/download/index.html">Downloading Jena</a></li>
<li><a href="/download/maven.html">Using Maven</a></li>
<li><a href="/download/osgi.html">Using OSGi</a></li>
</ul>
<h1 id="help-and-support">Help and support</h1>
<ul>
<li><a href="/help_and_support/index.html">Getting help</a></li>
<li><a href="/help_and_support/bugs_and_suggestions.html">Bugs and suggestions</a></li>
</ul>
<h1 id="getting-started">Getting Started</h1>
<ul>
<li><a href="/getting_started/index.html">A first Jena project</a></li>
<li><a href="/getting_started/rdf_api.html">RDF API overview</a></li>
<li><a href="/getting_started/sparql.html">Querying RDF with SPARQL</a></li>
<li><a href="/getting_started/fuseki.html">Serving RDF over HTTP</a></li>
<li><a href="/getting_started/tell_me_how.html">Tell me how to ...</a></li>
</ul>
<h1 id="tutorials">Tutorials</h1>
<ul>
<li><a href="/tutorials/index.html">Tutorials index</a></li>
<li><a href="/tutorials/rdf_api.html">RDF tutorial</a></li>
<li><a href="/tutorials/sparql.html">SPARQL queries</a></li>
<li><a href="/tutorials/using_jena_with_eclipse.html">Using Jena with Eclipse</a></li>
</ul>
<h1 id="documentation">Documentation</h1>
<ul>
<li><a href="/documentation/index.html">Overview</a></li>
<li><a href="/documentation/javadoc/">Javadoc</a></li>
<li><a href="/documentation/rdf/index.html">RDF</a></li>
<li><a href="/documentation/io/index.html">I/O</a></li>
<li><a href="/documentation/query/index.html">SPARQL (ARQ)</a><ul>
<li><a href="/documentation/query/app_api.html">Application API</a></li>
<li><a href="/documentation/query/cmds.html">Command line utilities</a></li>
</ul>
</li>
<li><a href="/documentation/query/text-query.html">Text Search</a></li>
<li><a href="/documentation/tdb/index.html">TDB</a><ul>
<li><a href="/documentation/tdb/tdb_transactions.html">API for Transactions</a></li>
<li><a href="/documentation/tdb/assembler.html">Dataset Assembler</a></li>
</ul>
</li>
<li><a href="/documentation/serving_data/index.html">Fuseki: Serving Data</a></li>
<li><a href="/documentation/ontology/index.html">Ontology</a></li>
<li><a href="/documentation/inference/index.html">Inference</a></li>
<li><a href="/documentation/assembler/index.html">Assembler</a><ul>
<li><a href="/documentation/assembler/assembler-howto.html">Assembler how-to</a></li>
<li><a href="/documentation/assembler/inside-assemblers.html">Inside assemblers</a></li>
</ul>
</li>
<li><a href="/documentation/sdb/index.html">SDB</a></li>
<li><a href="/documentation/notes/index.html">Notes</a><ul>
<li><a href="/documentation/notes/concurrency-howto.html">Concurrency how-to</a></li>
<li><a href="/documentation/notes/event-handler-howto.html">Event handler how-to</a></li>
<li><a href="/documentation/notes/file-manager.html">File manager how-to</a></li>
<li><a href="/documentation/notes/model-factory.html">Model factory how-to</a></li>
<li><a href="/documentation/notes/rdf-frames.html">RDF frames</a></li>
<li><a href="/documentation/notes/reification.html">Reification how-to</a></li>
<li><a href="/documentation/notes/typed-literals.html">Typed literals how-to</a></li>
<li><a href="/documentation/notes/iri.html">Support for IRI's</a></li>
<li><a href="/documentation/notes/sse.html">SSE</a></li>
</ul>
</li>
<li><a href="/documentation/tools/index.html">Tools</a><ul>
<li><a href="/documentation/tools/schemagen.html">schemagen</a></li>
<li><a href="/documentation/tools/eyeball-getting-started.html">eyeball</a></li>
</ul>
</li>
</ul>
<h1 id="getting-involved">Getting Involved</h1>
<ul>
<li><a href="/getting_involved/index.html">Contributing to Jena</a><ul>
<li><a href="/getting_involved/reviewing_contributions.html">Reviewing Contributions</a></li>
</ul>
</li>
</ul>
<h1 id="asf-links">ASF links</h1>
<ul>
<li><a href="http://www.apache.org">Apache Software Foundation</a></li>
<li><a href="http://www.apache.org/licenses/LICENSE-2.0">License</a></li>
<li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
<li><a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
<li><a href="http://www.apache.org/security/">Security</a></li>
</ul>
  </div>

  <div id="content">
    <h1 class="title">SPARQL Tutorial - Filters</h1>
    <p>Graph matching allows patterns in the graph to be found. This
section describes how the values in a solution can be restricted.
There are many comparisons available - we just cover two cases
here.</p>
<h2 id="string-matching">String Matching</h2>
<p>SPARQL provides an operation to test strings, based on regular
expressions.  This includes the ability to ask SQL "LIKE" style
tests, although the syntax of the regular expression is different
from SQL.</p>
<p>The syntax is:</p>
<div class="codehilite"><pre><span class="n">FILTER</span> <span class="n">regex</span><span class="p">(</span><span class="o">?</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;pattern&quot;</span> <span class="p">[,</span> <span class="s">&quot;flags&quot;</span><span class="p">])</span>
</pre></div>


<p>The flags argument is optional.  The flag "i" means a
case-insensitive pattern match is done.</p>
<p>The example query (<a href="sparql_data/q-f1.rq">q-f1.rq</a>) finds given names with an
"r" or "R" in them.</p>
<div class="codehilite"><pre><span class="n">PREFIX</span> <span class="n">vcard</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.w3.org/2001/vcard-rdf/3.0#&gt;</span>

<span class="n">SELECT</span> <span class="o">?</span><span class="n">g</span>
<span class="n">WHERE</span>
<span class="p">{</span> <span class="o">?</span><span class="n">y</span> <span class="n">vcard</span><span class="o">:</span><span class="n">Given</span> <span class="o">?</span><span class="n">g</span> <span class="p">.</span>
  <span class="n">FILTER</span> <span class="n">regex</span><span class="p">(</span><span class="o">?</span><span class="n">g</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">,</span> <span class="s">&quot;i&quot;</span><span class="p">)</span> <span class="p">}</span>
</pre></div>


<p>with the results:</p>
<div class="codehilite"><pre><span class="o">-------------</span>
<span class="o">|</span> <span class="n">g</span>         <span class="o">|</span>
<span class="o">=============</span>
<span class="o">|</span> <span class="s">&quot;Rebecca&quot;</span> <span class="o">|</span>
<span class="o">|</span> <span class="s">&quot;Sarah&quot;</span>   <span class="o">|</span>
<span class="o">-------------</span>
</pre></div>


<p>The regular expression language is the same as the
<a href="http://www.w3.org/TR/xpath-functions/#regex-syntax">XQuery regular expression language</a>
which is codified version of that found in Perl.</p>
<h2 id="testing-values">Testing Values</h2>
<p>There are times when the application wants to filter on the value
of a variable.  In the data file <a href="sparql_data/vc-db-2.rdf">vc-db-2.rdf</a>, we
have added an extra field for age.  Age is not defined by the vCard
schema so we have created a new property for the purpose of this
tutorial.  RDF allows such mixing of different definitions of
information because URIs are unique. Note also that the <code>info:age</code>
property value is typed.</p>
<p>In this extract of the data, we show the typed value. It can also
be written plain 23.</p>
<div class="codehilite"><pre><span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//somewhere/RebeccaSmith/&gt;</span>
    <span class="nl">info:</span><span class="n">age</span> <span class="s">&quot;23&quot;</span><span class="o">^^</span><span class="n">xsd</span><span class="o">:</span><span class="n">integer</span> <span class="p">;</span>
    <span class="nl">vCard:</span><span class="n">FN</span> <span class="s">&quot;Becky Smith&quot;</span> <span class="p">;</span>
    <span class="nl">vCard:</span><span class="n">N</span> <span class="p">[</span> <span class="n">vCard</span><span class="o">:</span><span class="n">Family</span> <span class="s">&quot;Smith&quot;</span> <span class="p">;</span>
              <span class="nl">vCard:</span><span class="n">Given</span>  <span class="s">&quot;Rebecca&quot;</span> <span class="p">]</span> <span class="p">.</span>
</pre></div>


<p>So, a query (<a href="sparql_data/q-f2.rq">q-f2.rq</a>) to find the names of people who
are older than 24 is:</p>
<div class="codehilite"><pre><span class="n">PREFIX</span> <span class="n">info</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//somewhere/peopleInfo#&gt;</span>

<span class="n">SELECT</span> <span class="o">?</span><span class="n">resource</span>
<span class="n">WHERE</span>
  <span class="p">{</span>
    <span class="o">?</span><span class="n">resource</span> <span class="n">info</span><span class="o">:</span><span class="n">age</span> <span class="o">?</span><span class="n">age</span> <span class="p">.</span>
    <span class="n">FILTER</span> <span class="p">(</span><span class="o">?</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">24</span><span class="p">)</span>
  <span class="p">}</span>
</pre></div>


<p>The arithmetic expression must be in parentheses (round brackets). 
The only solution is:</p>
<div class="codehilite"><pre><span class="o">---------------------------------</span>
<span class="o">|</span> <span class="n">resource</span>                      <span class="o">|</span>
<span class="o">=================================</span>
<span class="o">|</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//somewhere/JohnSmith/&gt; |</span>
<span class="o">---------------------------------</span>
</pre></div>


<p>Just one match, resulting in the resource URI for John Smith.
Turning this round to ask for those less than 24 also yields one
match for Rebecca Smith.  Nothing about the Jones's.</p>
<p>The database contains no age information about the Jones: there are
no info:age properties on these vCards so the variable <code>age</code> did
not get a value and so was not tested by the filter.</p>
<p><a href="sparql_optionals.html">Next: Optionals</a></p>
  </div>

  <div id="footer">
    <div class="copyright">
      <p>
        Copyright &copy; 2011&ndash;2013 The Apache Software Foundation, Licensed under
        the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        <br />
        Apache Jena, Jena, the Apache Jena project logo,
        Apache and the Apache feather logos are trademarks of The Apache Software Foundation.
      </p>
    </div>
  </div>

</body>
</html>
